<test>
    <configuration>xsam_config.xml</configuration>
    <function name="testName" module="Basic">
        <parameter>AP.TC.303</parameter>
    </function>

    <conditional configuration="XSAM/INTERNALSMSC" targetValue="">
        <function name="startSMSCServer" module="SMS">
            <configuration>SMSCServer/PORT</configuration>
            <parameter>UCP</parameter>
            <parameter>-1</parameter>
            <parameter>0</parameter>
            <parameter>0</parameter>
            <parameter>5</parameter><!--accept only 5 UCP sessions-->
            <parameter>0</parameter>
            <parameter>300000</parameter>
            <parameter>30000</parameter>
        </function>
    </conditional>

    <loop name="connection" start="1" stop="6" step="1">
        <thread>
            <function name="openConnection" module="UCP">
                <localvariable>connection</localvariable>
                <configuration>XSAM/IP</configuration>
                <configuration>XSAM/PORT</configuration>
            </function>

            <function name="sendUCPPacket" module="UCP">
                <localvariable>connection</localvariable>
                <parameter>internal</parameter>
                <parameter>O</parameter>
                <parameter>60</parameter>
                <parameter>
                    <parameter>/</parameter>
                    <configuration>XSAM/SHORTCODE</configuration>
                    <parameter>/6/1/1/70617373776F7264//0100//////</parameter>
                </parameter>
            </function>

            <function name="queryTextResponse" module="UCP">
                <localvariable>connection</localvariable>
                <parameter>secret</parameter>
                <parameter>\d\d/\d\d\d\d\d/R/60/A/[^/]++/\w\w</parameter>
            </function>

            <function name="sendUCPPacket" module="UCP">
                <localvariable>connection</localvariable>
                <parameter>internal</parameter>
                <parameter>O</parameter>
                <parameter>51</parameter>
                <parameter>
                    <parameter>/0123456789/</parameter>
                    <configuration>XSAM/SHORTCODE</configuration>
                    <parameter>/////////1/</parameter>
                    <parameter>///////2//12345678901234567890/////////////</parameter>
                </parameter>
            </function>

            <function name="queryTextResponse" module="UCP">
                <localvariable>connection</localvariable>
                <parameter>secret</parameter>
                <parameter>\d\d/\d\d\d\d\d/R/51/A//[^/]++/\w\w</parameter>
            </function>

            <function name="sleep" module="Basic">
                <parameter>240000</parameter>
            </function>

            <function name="sendUCPPacket" module="UCP">
                <localvariable>connection</localvariable>
                <parameter>internal</parameter>
                <parameter>O</parameter>
                <parameter>31</parameter>
                <parameter>/0123456789/0539/</parameter>
            </function>

            <function name="queryTextResponse" module="UCP">
                <localvariable>connection</localvariable>
                <parameter>secret</parameter>
                <parameter>\d\d/\d\d\d\d\d/R/31/A/\d\d\d\d/\w\w</parameter>
            </function>

            <function name="sleep" module="Basic">
                <parameter>610000</parameter>
            </function>

            <function name="checkConnection" module="UCP">
                <localvariable>connection</localvariable>
                <parameter>closed</parameter>
            </function>
            <function name="closeConnection" module="UCP">
                <localvariable>connection</localvariable>
            </function>
        </thread>
    </loop>

    <function name="sleep" module="Basic">
        <parameter>2000</parameter>
    </function>
    
    <function name="openConnection" module="UCP">
        <parameter>connection6</parameter>
        <configuration>XSAM/IP</configuration>
        <configuration>XSAM/PORT</configuration>
    </function>

    <function name="sendUCPPacket" module="UCP">
        <parameter>connection6</parameter>
        <parameter>internal</parameter>
        <parameter>O</parameter>
        <parameter>60</parameter>
        <parameter>
            <parameter>/</parameter>
            <configuration>XSAM/SHORTCODE</configuration>
            <parameter>/6/1/1/70617373776F7264//0100//////</parameter>
        </parameter>
    </function>

    <function name="queryTextResponse" module="UCP">
        <parameter>connection6</parameter>
        <parameter>secret</parameter>
        <parameter>\d\d/\d\d\d\d\d/R/60/N/04/[^/]++/\w\w</parameter>
    </function>


    <function name="waitOnThreads" module="Basic"/>
    <function name="stopSMSCServer" module="SMS"/>

</test>
